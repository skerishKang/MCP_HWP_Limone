# 한글 MCP 서버 개발 계획서

## 1. 프로젝트 개요

### 목표
기존 한글 MCP의 제한적인 기능을 넘어서, 한글(HWP)의 모든 기능을 프로그래밍적으로 제어할 수 있는 고도화된 MCP 서버 개발

### 현재 한글 MCP의 한계점
- 기본적인 텍스트 입력/폰트 설정만 가능
- 특정 위치나 범위 지정 불가능 (`select_previous_text`가 제대로 작동하지 않음)
- 고급 서식 기능 부족 (색상, 밑줄, 기울임, 배경색 등)
- 문서 구조 제어 제한적 (페이지 설정, 머리글/바닥글, 목차 등)
- 이미지 삽입, 도형 삽입 불가능
- 표 고급 기능 부족 (셀 병합, 테두리 스타일 등)

### 개발할 MCP 서버의 장점
- **완전한 제어**: 한글의 모든 COM API 기능 활용
- **정확한 위치 지정**: 좌표, 문단, 페이지 단위 정밀 제어
- **고급 서식**: 모든 글꼴 속성, 문단 서식, 페이지 레이아웃
- **문서 구조**: 복잡한 문서 구조 생성 및 편집
- **사용자 친화적**: Claude와의 자연어 대화로 문서 작업

## 2. 기술 스택 및 아키텍처

### 핵심 기술
- **Python 3.10+**: MCP 서버 개발 언어
- **MCP Python SDK**: Anthropic 공식 SDK 활용
- **pywin32**: 한글 COM 객체 제어
- **한글 COM API**: HWPFrame.HwpObject를 통한 완전한 제어

### 아키텍처 구조
```
Claude Desktop (MCP Client)
    ↕ (MCP Protocol)
Advanced HWP MCP Server (Python)
    ↕ (COM Interface)
한글 프로그램 (HWPFrame.HwpObject)
```

### 개발 환경
- **개발 도구**: VS Code + Python Extension
- **패키지 관리**: uv (현대적이고 빠른 Python 패키지 관리자)
- **MCP 프레임워크**: FastMCP (간편한 MCP 서버 개발)

## 3. 상세 기능 설계

### 3.1 문서 제어 기능
- **문서 생성/열기/저장**: 다양한 형식 지원 (HWP, DOC, PDF 등)
- **문서 정보**: 페이지 수, 문자 수, 작성자 정보 등
- **문서 속성**: 보안 설정, 편집 권한 등

### 3.2 텍스트 조작 기능
- **정밀 입력**: 특정 위치, 문단, 페이지에 텍스트 삽입
- **텍스트 선택**: 좌표, 문자 범위, 문단 범위, 페이지 범위
- **텍스트 편집**: 찾기/바꾸기, 삭제, 이동, 복사
- **텍스트 검색**: 정규식 지원, 고급 검색 옵션

### 3.3 서식 및 스타일
- **글꼴 서식**: 글꼴명, 크기, 색상, 굵기, 기울임, 밑줄, 취소선
- **문단 서식**: 정렬, 들여쓰기, 줄 간격, 문단 간격
- **페이지 서식**: 여백, 용지 크기, 방향, 머리글/바닥글
- **스타일**: 사용자 정의 스타일 생성 및 적용

### 3.4 표 기능
- **표 생성**: 행/열 수 지정, 자동 크기 조정
- **표 편집**: 셀 병합/분할, 행/열 추가/삭제
- **표 서식**: 테두리 스타일, 배경색, 셀 정렬
- **표 데이터**: CSV/Excel 데이터 자동 입력

### 3.5 객체 삽입
- **이미지**: 파일에서 이미지 삽입, 크기 조정, 위치 조정
- **도형**: 사각형, 원, 선, 화살표 등 기본 도형
- **차트**: Excel 연동 차트 삽입
- **하이퍼링크**: URL, 문서 내 책갈피 링크

### 3.6 고급 기능
- **매크로 실행**: 기존 한글 매크로 실행
- **PDF 변환**: 문서를 PDF로 내보내기
- **인쇄 제어**: 인쇄 설정 및 실행
- **문서 보호**: 암호 설정, 편집 제한

## 4. 개발 단계별 계획

### Phase 1: 기본 인프라 구축 (1주)
- [x] MCP 서버 프레임워크 설정
- [x] 한글 COM 객체 연결 확인
- [x] 기본 문서 생성/열기/저장 기능
- [x] 간단한 텍스트 입력 기능

### Phase 2: 핵심 텍스트 기능 (1주)
- [x] 정밀한 텍스트 위치 지정
- [x] 텍스트 선택 및 범위 지정
- [x] 기본 서식 적용 (글꼴, 크기, 굵기 등)
- [x] 찾기/바꾸기 기능

### Phase 3: 고급 서식 기능 (1주)
- [x] 문단 서식 (정렬, 들여쓰기, 줄간격)
- [x] 페이지 서식 (여백, 용지 설정)
- [x] 스타일 생성 및 적용
- [x] 색상 및 효과 적용

### Phase 4: 표 및 객체 기능 (1주)
- [x] 표 생성 및 편집
- [x] 이미지 삽입 및 조정
- [x] 도형 및 그래픽 객체
- [x] 하이퍼링크 관리

### Phase 5: 고급 기능 및 최적화 (1주)
- [x] 문서 구조 관리 (머리글/바닥글, 목차)
- [x] PDF 변환 및 인쇄
- [x] 성능 최적화
- [x] 오류 처리 강화

### Phase 6: 테스트 및 문서화 (1주)
- [x] 전체 기능 테스트
- [x] Claude Desktop 연동 테스트
- [x] 사용자 가이드 작성
- [x] 예제 및 샘플 코드

## 5. 기술적 세부사항

### 5.1 MCP 서버 구조
```python
from mcp.server.fastmcp import FastMCP
import win32com.client
import pythoncom

# MCP 서버 초기화
mcp = FastMCP("Advanced HWP Server")

# 한글 COM 객체 관리
class HwpController:
    def __init__(self):
        pythoncom.CoInitialize()
        self.hwp = win32com.client.gencache.EnsureDispatch("HWPFrame.HwpObject")
        
    def __del__(self):
        pythoncom.CoUninitialize()
```

### 5.2 핵심 도구 예시
- `create_document()`: 새 문서 생성
- `insert_text_at_position()`: 특정 위치에 텍스트 삽입
- `select_text_range()`: 텍스트 범위 선택
- `apply_font_format()`: 글꼴 서식 적용
- `insert_table()`: 표 삽입 및 설정
- `insert_image()`: 이미지 삽입 및 조정
- `set_page_format()`: 페이지 설정

### 5.3 오류 처리 전략
- COM 객체 초기화 실패 처리
- 한글 프로그램 미설치 상황 대응
- 문서 형식 호환성 검사
- 메모리 누수 방지

## 6. 예상 사용 시나리오

### 시나리오 1: 보고서 자동 생성
```
사용자: "회사 로고를 상단에 넣고, 제목을 '2024년 4분기 실적보고서'로 하고, 3단으로 구성된 표를 만들어줘"
Claude: (Advanced HWP MCP를 통해 자동으로 문서 생성)
```

### 시나리오 2: 일괄 서식 적용
```
사용자: "모든 제목을 맑은고딕 16pt 굵게, 본문을 바탕 11pt로 변경해줘"
Claude: (문서 전체의 서식을 자동으로 변경)
```

### 시나리오 3: 데이터 기반 문서 생성
```
사용자: "첨부된 엑셀 데이터를 표로 만들고, 각 항목별로 차트를 삽입해줘"
Claude: (데이터를 분석하고 자동으로 표와 차트가 포함된 문서 생성)
```

## 7. 성공 지표

### 기능적 지표
- 한글 COM API의 90% 이상 기능 커버
- 기존 MCP 대비 10배 이상 많은 기능 제공
- 텍스트 위치 지정 정확도 100%

### 성능 지표
- 문서 생성 시간 < 2초
- 복잡한 서식 적용 시간 < 5초
- 메모리 사용량 < 100MB

### 사용성 지표
- Claude와의 자연어 명령 성공률 > 95%
- 오류 발생률 < 1%
- 사용자 만족도 > 4.5/5.0

## 8. 리스크 및 대응방안

### 기술적 리스크
- **한글 버전 호환성**: 다양한 한글 버전 테스트 필요
- **COM 객체 안정성**: 적절한 예외 처리 및 재시도 메커니즘
- **메모리 관리**: COM 객체 생명주기 관리

### 대응방안
- 단계적 개발로 위험 요소 조기 발견
- 충분한 테스트 케이스 작성
- 커뮤니티 피드백 적극 수용

## 9. 향후 확장 계획

### 단기 확장 (3개월)
- 한셀(Excel) MCP 서버 개발
- 한쇼(PowerPoint) MCP 서버 개발
- 한글 스타일 템플릿 라이브러리

### 장기 확장 (6개월)
- 웹 기반 한글 편집기 연동
- AI 기반 문서 자동 생성
- 다국어 지원 및 국제화

## 10. 결론

이 프로젝트를 통해 우리는 한글 문서 작업의 새로운 패러다임을 제시할 수 있습니다. 
Claude와 자연어로 대화하며 복잡한 문서를 자동으로 생성하고 편집하는 경험은 
사용자의 생산성을 혁신적으로 향상시킬 것입니다.

기술적으로는 MCP 프로토콜의 활용 사례를 제시하고, 
한국의 대표적인 오피스 소프트웨어인 한글과의 통합을 통해 
실용적인 가치를 창출할 수 있을 것입니다.
